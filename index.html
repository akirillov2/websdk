<!doctype html>
<html>
  <head>
    
    <!-- GTM Datalayer init -->
    <script>
    window.dataLayer = window.dataLayer || [];
    </script>
    
    <!-- Google Tag Manager -->
    <script>(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start':
    new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0],
    j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src=
    'https://www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f);
    })(window,document,'script','dataLayer','GTM-W8VSX4T');</script>
    <!-- End Google Tag Manager -->
    
    <title>People WebSDK with GTM</title>
  </head>
  <body>
    
    <!-- Google Tag Manager (noscript) -->
    <noscript><iframe src="https://www.googletagmanager.com/ns.html?id=GTM-W8VSX4T"
    height="0" width="0" style="display:none;visibility:hidden"></iframe></noscript>
    <!-- End Google Tag Manager (noscript) -->
    
    <h1>People WebSDK test site</h1>
    <hr>   
    
    <h2>Login form:</h2>
    <form class="login-form">
       <div>
        <label for="email">User email: </label>
        <input type="text" name="email" id="email" required>
      </div>
      <div>
        <input type="submit" value="Log In">
      </div>
    </form>
    
    <hr>
    
    <h2>Profile update form (attribute = firstName):</h2>
    <form class="profile-form">
      <div>
        <label for="property">Attribute Value: </label>
        <input type="text" name="property" id="property" required>
      </div>
      <div>
        <input type="submit" value="Update Profile">
      </div>
    </form>
    
    <hr>
    
    <h2>Send event form (event = purchasealex):</h2>
     <form class="event-form">
       <div>
        <label for="product">Product Name: </label>
        <input type="text" name="product" id="product" required>
      </div>
      <div>
        <label for="qty">Quantity: </label>
        <input type="text" name="qty" id="qty">
      </div>
      <div>
        <input type="submit" value="Send Event">
      </div>
    </form>
    
     <script>
      const onLoginFormSubmit = (evt) => {
        evt.preventDefault();
        const formData = new FormData(document.querySelector('.login-form'));
        const formEmail = formData.get('email');
        window.dataLayer.push({'user_id': formEmail, 'event': 'login'});
        console.log('Logged In');
      };
       
      const onSendClick = (evt) => {
        evt.preventDefault();
        const formData = new FormData(document.querySelector('.event-form'));
        const formProduct = formData.get('product');
        const formQty = formData.get('qty');
        window.dataLayer.push({'product_name': formProduct, 'qty': formQty, 'event': 'send_event'});
        console.log('Sent Event');
      };
       
       const onUpdateClick = (evt) => {
        evt.preventDefault();
        const formData = new FormData(document.querySelector('.profile-form'));
        const formProp = formData.get('property');
        window.dataLayer.push({'attr_value': formProp, 'event': 'update_profile'});
        console.log('Updated Profile');
      };

      const loginForm = document.querySelector('.login-form');
      loginForm.addEventListener('submit', onLoginFormSubmit);
      const profileForm = document.querySelector('.profile-form');
      profileForm.addEventListener('submit', onUpdateClick);
      const eventForm = document.querySelector('.event-form');
      eventForm.addEventListener('submit', onSendClick);
    </script>
    
   
  </body>
</html>
